# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ - RoyalQ Salebot

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

–°–µ—Ä–≤–∏—Å—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—É —Å –¥–∞–Ω–Ω—ã–º–∏. –û–Ω–∏ —Å–ª–µ–¥—É—é—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É **Single Responsibility** –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –∏ –º–æ–¥–µ–ª—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Controllers   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ    Services     ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ     Models      ‚îÇ
‚îÇ   (HTTP Layer)  ‚îÇ    ‚îÇ (Business Logic)‚îÇ    ‚îÇ   (Data Layer)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìã ReferalService

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º–∏, –≤–∫–ª—é—á–∞—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

#### `createReferal(referalData)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `referalData` (Object) - –¥–∞–Ω–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Document>` - —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–∞

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è**:
- `Error` - –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
```javascript
const referalData = {
  referal_id: "user123",
  referer_id: "parent456",
  referal_nickname: "john_doe",
  referal_name: "John Doe"
};

const newReferal = await referalService.createReferal(referalData);
```

#### `getReferalById(referalId)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –ø–æ –µ–≥–æ ID

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `referalId` (String) - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–µ—Ñ–µ—Ä–∞–ª–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Document|null>` - –¥–æ–∫—É–º–µ–Ω—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –∏–ª–∏ null

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è**:
- `Error` - –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–∏—Å–∫–∞

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `.lean()` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–æ—Å—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

#### `updateReferal(referalId, updateData)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `referalId` (String) - ID —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `updateData` (Object) - –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Document|null>` - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `findOneAndUpdate` —Å –æ–ø—Ü–∏–µ–π `{ new: true }`

#### `deleteReferal(referalId)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `referalId` (String) - ID —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Document|null>` - —É–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
1. –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–º
2. –£–¥–∞–ª—è–µ—Ç —Å–∞–º–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `findOneAndDelete` –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏

#### `getReferalTree(refererId, depth, currentDepth)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≥–ª—É–±–∏–Ω—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `refererId` (String) - ID —Ä–µ—Ñ–µ—Ä–µ—Ä–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞
- `depth` (Number) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4)
- `currentDepth` (Number) - —Ç–µ–∫—É—â–∞—è –≥–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Array>` - –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–µ—Ä–µ–≤–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º**:
1. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞
2. –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö**:
```javascript
[
  {
    referal_id: "user123",
    referer_id: "parent456",
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª–∞
    children: [
      {
        referal_id: "child1",
        referer_id: "user123",
        // ... –ø–æ–ª—è –¥–æ—á–µ—Ä–Ω–µ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞
        children: [],
        totalReferals: 0
      }
    ],
    totalReferals: 5 // –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
  }
]
```

## üí∞ PaymentService

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞–º–∏ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Å–≤—è–∑–µ–π —Å —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

#### `createPayment(paymentData)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `paymentData` (Object) - –¥–∞–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Document>` - —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø–ª–∞—Ç–µ–∂–∞

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `userId`
2. **–°–æ–∑–¥–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–µ—Ñ–µ—Ä–∞–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. **–û—à–∏–±–∫–∞**: –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É 400 –µ—Å–ª–∏ —Ä–µ—Ñ–µ—Ä–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω

**–ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
```javascript
const existingReferal = await Referal.findOne({ referal_id: userId }).lean();
if (!existingReferal) {
  const error = new Error(`Referal with referal_id "${userId}" not found. Payment cannot be created.`);
  error.statusCode = 400;
  throw error;
}
```

#### `getPaymentsByUserId(userId)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `userId` (String) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (referal_id)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Promise<Document[]>` - –º–∞—Å—Å–∏–≤ –ø–ª–∞—Ç–µ–∂–µ–π

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `.lean()` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —á—Ç–µ–Ω–∏—è

## ü§ñ SalebotService

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–°–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º API Salebot (–∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è –±—É–¥—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
```javascript
class SalebotService {
  constructor() {
    this.apiClient = axios.create({
      baseURL: salebotConfig.baseUrl,
    });
  }

  async getReferalData(referalId) {
    // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –∏–∑ Salebot API
  }

  async getPaymentData(transactionId) {
    // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–∞ –∏–∑ Salebot API
  }
}
```

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã
- `getReferalData(referalId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–∞
- `getPaymentData(transactionId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–∞
- `syncReferals()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- `processWebhook(data)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤

## üîÑ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### Dependency Injection
–°–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã –º–æ–¥–µ–ª–µ–π:
```javascript
import Referal from '../models/referal.model.js';
import Payment from '../models/payment.model.js';
```

### Error Handling
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Å–ª–µ–¥—É—é—Ç –µ–¥–∏–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:
```javascript
try {
  // –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
  return result;
} catch (error) {
  console.error("Error description:", error);
  throw error; // –ü—Ä–æ–±—Ä–æ—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
}
```

### Async/Await
–í—Å–µ –º–µ—Ç–æ–¥—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç async/await –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

### Lean Queries
–î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.lean()`:
```javascript
return await Referal.findOne({ referal_id: referalId }).lean();
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
1. **Lean Queries** - –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–æ—Å—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤–º–µ—Å—Ç–æ Mongoose –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
2. **–ò–Ω–¥–µ–∫—Å—ã** - –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è (`referal_id`, `referer_id`, `userId`)
3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏ –≤ –¥–µ—Ä–µ–≤–µ
4. **Batch Operations** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

### Unit —Ç–µ—Å—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
```javascript
describe('ReferalService', () => {
  describe('createReferal', () => {
    it('should create referal with valid data', async () => {
      const referalData = { referal_id: 'test123' };
      const result = await referalService.createReferal(referalData);
      expect(result.referal_id).toBe('test123');
    });

    it('should throw error for duplicate referal_id', async () => {
      // –¢–µ—Å—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
    });
  });
});
```

### Integration —Ç–µ—Å—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# Salebot API
SALEBOT_API_BASE_URL=https://api.salebot.pro
SALEBOT_API_KEY=your_api_key_here

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
MONGODB_URI=mongodb://localhost:27017/royalq-salebot
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Mongoose
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏
- Middleware –¥–ª—è –∫–∞—Å–∫–∞–¥–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è

## üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–æ –¥–æ–º–µ–Ω–∞–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—á–µ—Ä–µ–¥–µ–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ connection pooling
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Salebot API
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: $(date)*  
*–í–µ—Ä—Å–∏—è: 1.0.0*
